<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin</title>
    <link rel="stylesheet" href="admin-style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body class="admin">
    <header class="navbar">
      <i class="fa-solid fa-bars fa-2xl" style="color: white; margin-left: 10px;" ></i>
      <div class="navbar-right">
      <p>ADMIN</p>
      <img src="logo.png" class="admin-logo" alt="Shield Logo" />
      </div>
    </header>
    <div class="register-medicine-cnt">
        <div class="register-medicine">
        <h1 class="admin-h1">
            Register Medicine
        </h1>
        <form class="register-form">
            <label class="label"  for="medicine-name">Medicine Name:</label><br>
            <input type="text" class="input" name="medicine-name" placeholder="Enter Medicine Name" required><br>
            
            <label class="label"for="medicine-id">Batch No:</label><br>
            <input type="text" class="input" name="Batch No:" placeholder="Enter Batch No:" required><br>
            
            <label class="label" for="hash-code">Hash Code:</label><br>
            <input type="text" class="input" name="hash-code"  placeholder="Enter hash-code"><br>

            <label class="label" for="expiry-date">Expiry Date:</label><br>
            <input type="date" class="input" name="expiry-date" required><br>
            
            <button class="admin-submit" type="submit">Register</button>
        </form>
        </div>
    </div>
</body>

<script>
document.querySelector('.register-form').addEventListener('submit', async function(e) {
    e.preventDefault();

    const medicineName = document.querySelector('input[name="medicine-name"]').value.trim();
    const batchNo = document.querySelector('input[name="Batch No:"]').value.trim();
    const hashCode = document.querySelector('input[name="hash-code"]').value.trim();
    const expiryDate = document.querySelector('input[name="expiry-date"]').value;

    if (!medicineName || !batchNo || !expiryDate) {
        alert('Please fill all required fields.');
        return;
    }

    const data = {
        medicine_name: medicineName,
        batch_no: batchNo,
        hash_code: hashCode,
        expiry_date: expiryDate
    };

    try {
        const response = await fetch('/api/register-medicine', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });

        if (response.ok) {
            alert('Medicine registered successfully!');
            document.querySelector('.register-form').reset();
        } else {
            const error = await response.json();
            alert('Error: ' + (error.message || 'Registration failed.'));
        }
    } catch (err) {
        alert('Network error. Please try again.');
    }
});
</script>

</html>